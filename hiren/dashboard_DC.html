<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
<!--        Notes:
        In order to use D3 set char to utf-8, load crossfilter.js before dc.js-->
        <!--<link rel="icon" href="img/favicon.png" sizes="16x16" type="image/png">-->
   
        
        
        <!--remember to remove the below ds-->
             
<script src="https://code.jquery.com/jquery-3.3.1.min.js" crossorigin="anonymous"></script>
  
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>

<!--<script src="lib/d3.tip.js" type="text/javascript"></script>
<link href="lib/d3_tooltip.css" rel="stylesheet" type="text/css"/>-->
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/crossfilter2/1.4.6/crossfilter.min.js" type="text/javascript"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/dc/2.1.10/dc.min.js" type="text/javascript"></script>                
        <link href="https://cdnjs.cloudflare.com/ajax/libs/dc/2.1.10/dc.min.css" rel="stylesheet" type="text/css"/>
        
<!--        <script src="lib/transition-test.js" type="text/javascript"></script>
        <script src="lib/ordinal-transition.js" type="text/javascript"></script>-->
        <!--<link href="lib/w3_css_for_tabs.css" rel="stylesheet" type="text/css"/>-->  
        
<!--make data table-->

        <link href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css" rel="stylesheet" type="text/css"/>       
        <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js" type="text/javascript"></script>
        
        <link href="//cdn.datatables.net/plug-ins/1.10.19/features/searchHighlight/dataTables.searchHighlight.css" rel="stylesheet" type="text/css"/>
        <script src="http://cdn.datatables.net/plug-ins/1.10.19/features/searchHighlight/dataTables.searchHighlight.min.js" type="text/javascript"></script>
        <script src="lib/data_tables/searchHighlight/jquery_highlight_plugin.js" type="text/javascript"></script>
        
        <!--datatable export-->
       
        <script src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.html5.min.js" type="text/javascript"></script>
        <script src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.print.min.js" type="text/javascript"></script>
        <script src="https://cdn.datatables.net/buttons/1.5.2/js/dataTables.buttons.min.js" type="text/javascript"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js" type="text/javascript"></script>     
        <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js" type="text/javascript"></script>

        <!--chosen.js-->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.7/chosen.min.css" rel="stylesheet" type="text/css"/>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.8.7/chosen.jquery.min.js" type="text/javascript"></script>
        
             
         <!--change tab colour and display of tabs-->
<!--        <script src="lib/tab_colour.js" type="text/javascript" defer></script>
        
        <link href="lib/dashboard_css.css" rel="stylesheet" type="text/css"/>-->
        <!--<script src="myds.js" type="text/javascript"></script>-->
     
        <link href="css/myStyle.css" rel="stylesheet" type="text/css"/>
        <script src="data/myds.js"></script>
    </head>        

    <body>
        
        

        <h1>My first DC.js Dashboard</h1>
        <button type="button" onClick = "resetData()"> reset </button>
        <button data-toggle="collapse" data-target="#chartsSection">show/hide charts</button>
        <section id = "chartsSection" class = "collapse in">
        <div id="parentCon" class="row hiren">
            <div class="col-lg-6" id="chart1"> <p class = "chartTitle">Car count by type </p> </div>
            <div class="col-lg-6" id="chart2"> <p class = "chartTitle">Car type by colour</p></div>
        </div>
        
        <div class="row">
            <div class="col-lg-6" id="chart3"> <p class = "chartTitle">Car count by type</p></div>
        </div>
        
        </section>
        
        <button data-toggle="collapse" data-target="#tableSection" >show/hide table</button>

        <section id = "tableSection" class="collapse in">

        <div id="mytable" class="row" >
                <div class="col-lg-12">
                <table class="table table-striped table-bordered table-hover" id="alltable" cellspacing="0">
                        <thead>
                                <tr>
                                    <th>Car</th>
                                    <th>Max speed</th>
                                    <th>Colour</th>
                                    <th>Cost</th>
                                   
                                 
                                </tr>
                        </thead>

                        <tbody class="ds_table">
                            
                        </tbody>
                </table>         
                </div>
            </div> <!--table end-->
        </section>
        <script>
var chart1 = dc.barChart("#chart1");
var chart2 = dc.barChart("#chart2");
var chart3 = dc.pieChart("#chart3");
  
var cf_ds = crossfilter(ds);

//Dimensions
var name_dim = cf_ds.dimension(function(d){return d.car;});
var colour_dim = cf_ds.dimension(function(d){return d.colour;});

var name_dim2 = cf_ds.dimension(function(d){return d.car;});

//Grouping
var name_grp = name_dim.group().reduceCount();
var colour_grp = colour_dim.group().reduceCount();

var name_grp2 = name_dim2.group().reduceCount();

//Chart function 

chart1
    .x(d3.scale.ordinal())
    .xUnits(dc.units.ordinal)     
    .dimension(name_dim)
    .group(name_grp)
    .on("filtered",function(){        
                $("#alltable").DataTable().clear().draw();
                $("#alltable").DataTable().rows.add(name_dim.top(Infinity)).draw();
                })   
;

chart2
    .x(d3.scale.ordinal())
    .xUnits(dc.units.ordinal)     
    .dimension(colour_dim)
    .group(colour_grp)
    .on("filtered",function(){        
                $("#alltable").DataTable().clear().draw();
                $("#alltable").DataTable().rows.add(name_dim.top(Infinity)).draw();
                })
        
;

chart3
//    .width(300)
//    .height(480)
    .slicesCap(4)
    .innerRadius(30)
    .dimension(name_dim2)
    .group(name_grp2)
    .legend(dc.legend())
    .on("filtered",function(){        
                $("#alltable").DataTable().clear().draw();
                $("#alltable").DataTable().rows.add(name_dim2.top(Infinity)).draw();
                })
    ;
    
  



chart1.render(); //chart rendered at this point
chart2.render(); //chart rendered at this point
chart3.render(); //chart rendered at this point
;



var p = {
            age:function(dob){return 2019 - dob;},
            age_of_car:function(car_age){return 2019 - car_age;}
        
        };




window.onresize = function(){
   chart1.width($("#chart1").width());
   chart1.rescale();
   chart1.redraw();
   
   
    chart2.width($("#chart1").width());
   chart2.rescale();
   chart2.redraw();
   ;
    
};
        
        






            
        </script>
        
        <script>
//Table

$('#alltable').DataTable({
            pageLength: 25,
//            scrollX:true,
//            scrollY:600,
            searchHighlight: true,
            data: name_dim.top(Infinity),
//            language:{thousands:","}, 
            deferRender: true,
//            searchHighlight:true,
            dom: 'Blfrtip',
            buttons: [{extend: 'csv',title:"My table".downloadFileName},
                      {extend: 'excel',title:"My table".downloadFileName}
            ],


// <th>Car</th>
//                                    <th>Max speed</th>
//                                    <th>Colour</th>
//                                    <th>Cost</th>

columns:[
{data:"car",width:"400px"},
{data:"max_speed",width:"400px"},
{data:"colour",width:"400px"},
{data:"cost",width:"400px"}
]

//columnDefs:[
//{title:"Response ID",targets:0},
//{title:"What is the name of your business?",targets:1},
//{title:"Is your business aware of the Economic Partnership Agreement (EPA) that came into force between the EU and Japan in February this year?", targets:2},
//{title:"Which of the following trade related areas best describe the areas of the Economic Partnership Agreement that are  important to your business?",targets:3}
//
//  ]
} );
            
            
        </script>
        
        
        
    </body>
</html>
